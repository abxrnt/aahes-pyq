<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PROYAX PYQ Portal</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&family=Merriweather:ital,wght@0,400;0,700;1,700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    :root{--accent-1:#06a6ff;--accent-2:#0ea5a3}
    html,body{height:100%;margin:0;font-family:'Quicksand',sans-serif;background:#061826;color:#fff}
    /* split layout like your screenshot */
    .split{display:flex;height:100vh;overflow:hidden}
    .left{flex:1;display:flex;align-items:center;padding:6rem 6vw;background:linear-gradient(120deg,#063147 0%, #0b4b4d 100%);border-top-right-radius:40px;border-bottom-right-radius:40px}
    .right{flex:1;display:flex;align-items:center;justify-content:center;padding:4rem;background:url('bg-right.jpg') center/cover no-repeat}

    .card{width:100%;max-width:520px}
    .title{font-family:'Merriweather',serif;font-size:52px;margin-bottom:1.2rem;color:#f3fbff}
    .subtitle{color:rgba(243,251,255,0.85);margin-bottom:2rem}

    .input{width:100%;padding:18px 20px;border-radius:18px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.03);color:#e6f7fb;margin-bottom:16px;box-sizing:border-box}
    .input::placeholder{color:rgba(230,247,251,0.45)}

    .btn{display:block;width:100%;padding:16px;border-radius:16px;background:linear-gradient(90deg,var(--accent-2),var(--accent-1));color:#003; font-weight:700;border:none;margin-top:6px}
    .link{color:#ffd24d;cursor:pointer;text-decoration:underline}

    .small{font-size:14px;color:rgba(255,255,255,0.8);margin-top:12px}
    .center{display:flex;gap:12px;align-items:center}

    /* register form styles (slightly different) */
    .muted{color:rgba(255,255,255,0.6)}

    @media (max-width:900px){.split{flex-direction:column}.left{border-radius:0;padding:3rem}.right{height:40vh}}
  </style>
</head>
<body>

  <div class="split">
    <!-- LEFT: form area (matches screenshot look) -->
    <div class="left">
      <div class="card" id="authCard">
        <div id="loginView">
          <div class="title">Welcome Back</div>
          <div class="subtitle muted">Login to access previous year questions and practice faster.</div>

          <input id="email" class="input" placeholder="Email" />
          <input id="password" type="password" class="input" placeholder="Password" />
          <button id="loginBtn" class="btn">Login</button>

          <div class="small">Forgot your password? <a class="link" id="forgot">Click here</a></div>
          <div class="small" style="margin-top:18px">Don't have an account? <a id="showRegister" class="link">Register</a></div>
        </div>

        <div id="registerView" style="display:none">
          <div class="title">Create Account</div>
          <div class="subtitle muted">Register with your full name and email to get started.</div>

          <input id="regName" class="input" placeholder="Full name" />
          <input id="regEmail" class="input" placeholder="Email" />
          <input id="regPass" type="password" class="input" placeholder="Password (min 6 chars)" />

          <button id="registerBtn" class="btn">Register</button>

          <div class="small">Already have an account? <a id="showLogin" class="link">Login</a></div>
        </div>
      </div>
    </div>

    <!-- RIGHT: branding area (keeps your hero look) -->
    <div class="right" aria-hidden="true">
      <div style="text-align:center;color:#fff;max-width:520px">
        <img src="favicon.png" alt="logo" style="width:96px;margin-bottom:16px">
        <h1 style="font-family:'Merriweather',serif;font-size:42px;margin:0 0 12px">PROYAX PYQ Portal</h1>
        <p style="opacity:0.9;line-height:1.6">Access previous year questions as images easily. Prepare smarter and faster for your exams.</p>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = { apiKey: "AIzaSyBOVl1hdmprJXpgdN_sNTO3FsNePD_zNZY", authDomain: "aahes-cee-cutoffs.firebaseapp.com", projectId: "aahes-cee-cutoffs", storageBucket: "aahes-cee-cutoffs.firebasedatabase.app", messagingSenderId: "706066626405", appId: "1:706066626405:web:0d254ab82beb288108938c" };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    // elements
    const loginView = document.getElementById('loginView');
    const registerView = document.getElementById('registerView');
    const showRegister = document.getElementById('showRegister');
    const showLogin = document.getElementById('showLogin');

    const email = document.getElementById('email');
    const password = document.getElementById('password');
    const loginBtn = document.getElementById('loginBtn');

    const regName = document.getElementById('regName');
    const regEmail = document.getElementById('regEmail');
    const regPass = document.getElementById('regPass');
    const registerBtn = document.getElementById('registerBtn');

    // toggle
    showRegister.addEventListener('click', ()=>{ loginView.style.display='none'; registerView.style.display='block'; window.scrollTo(0,0); });
    showLogin.addEventListener('click', ()=>{ registerView.style.display='none'; loginView.style.display='block'; window.scrollTo(0,0); });

    // login handler (attempt Firebase Auth, fallback to users collection match)
    loginBtn.addEventListener('click', async ()=>{
      const e = email.value.trim(); const p = password.value.trim();
      if(!e || !p){ alert('Enter email and password'); return; }
      try{
        try{
          await signInWithEmailAndPassword(auth, e, p);
        } catch(err){
          // fallback: check users collection
          const q = query(collection(db,'users'), where('email','==', e));
          const snap = await getDocs(q);
          if(snap.empty){ alert('User not found'); return; }
          let ok=false;
          snap.forEach(d=>{ if(d.data().password === p) ok=true; });
          if(!ok){ alert('Incorrect password'); return; }
        }
        // success: hide overlay, redirect or show main app (here we just alert)
        alert('Login successful — hiding auth. (Replace this with your hideAuth() code)');
        // TODO: call hideAuth() and initialize app state here
      } catch(e){ console.error(e); alert('Login failed'); }
    });

    // register handler
    registerBtn.addEventListener('click', async ()=>{
      const name = regName.value.trim(); const e = regEmail.value.trim(); const p = regPass.value.trim();
      if(!name || !e || !p){ alert('Provide name, email and password'); return; }
      if(p.length < 6){ alert('Password must be at least 6 characters'); return; }
      try{
        // create Firestore user doc
        await addDoc(collection(db,'users'), { name, email: e, password: p, createdAt: new Date() });
        // try to create auth user (best effort)
        try{ await createUserWithEmailAndPassword(auth, e, p); } catch(e){ console.warn('Auth create skipped', e); }
        alert('Registered successfully — please login.');
        // switch to login view
        registerView.style.display='none'; loginView.style.display='block'; email.value = e; password.value = '';
        regName.value=''; regEmail.value=''; regPass.value='';
      } catch(err){ console.error('Registration failed', err); alert('Registration failed'); }
    });
  </script>
</body>
</html>
